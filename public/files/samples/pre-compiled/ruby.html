<span class='l l-1 source ruby'><s class='meta class ruby'><s class='keyword control class ruby'>class</s> <s class='entity name type class ruby'>HTMLProcessor</s></s>
</span><span class='l l-2 source ruby'>
</span><span class='l l-3 source ruby'><s class='comment line number-sign ruby'>  <s class='punctuation definition comment ruby'>#</s> called before parsing anything
</s></span><span class='l l-4 source ruby'>  <s class='meta function method with-arguments ruby'><s class='keyword control def ruby'>def</s> <s class='entity name function ruby'>start_parsing</s><s class='punctuation definition parameters ruby'>(</s><s class='variable parameter function ruby'>scope_name</s><s class='punctuation definition parameters ruby'>)</s></s>
</span><span class='l l-5 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>line</s> <s class='keyword operator assignment ruby'>=</s> <s class='string quoted double ruby'><s class='punctuation definition string begin ruby'>"</s><s class='punctuation definition string end ruby'>"</s></s>
</span><span class='l l-6 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>offset</s> <s class='keyword operator assignment ruby'>=</s> <s class='constant numeric ruby'>0</s>
</span><span class='l l-7 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>text</s><s class='keyword operator assignment ruby'>=</s> <s class='punctuation section array ruby'>[</s><s class='punctuation section array ruby'>]</s>
</span><span class='l l-8 source ruby'>  <s class='keyword control ruby'>end</s>
</span><span class='l l-9 source ruby'>
</span><span class='l l-10 source ruby'><s class='comment line number-sign ruby'>  <s class='punctuation definition comment ruby'>#</s> called after parsing everything
</s></span><span class='l l-11 source ruby'>  <s class='meta function method with-arguments ruby'><s class='keyword control def ruby'>def</s> <s class='entity name function ruby'>end_parsing</s><s class='punctuation definition parameters ruby'>(</s><s class='variable parameter function ruby'>scope_name</s><s class='punctuation definition parameters ruby'>)</s></s>
</span><span class='l l-12 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>text</s><s class='meta function-call method without-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>each_with_index</s></s> <s class='keyword control ruby start-block'>do </s><s class='punctuation separator variable ruby'>|</s><s class='variable other block ruby'>line</s><s class='punctuation separator variable ruby'>,</s> <s class='variable other block ruby'>index</s><s class='punctuation separator variable ruby'>|</s>
</span><span class='l l-13 source ruby'>      <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>text</s><s class='punctuation section array ruby'>[</s>index<s class='punctuation section array ruby'>]</s> <s class='keyword operator assignment ruby'>=</s> <s class='string quoted double ruby'><s class='punctuation definition string begin ruby'>"</s>&lt;span class='l<s class='source ruby embedded source'><s class='punctuation section embedded ruby'> l</s>-#{in<s class='keyword operator arithmetic ruby'>d</s><s class='constant numeric ruby'>e</s><s class='punctuation section embedded ruby'>x</s></s>+<s class='source ruby embedded source'><s class='punctuation section embedded ruby'>1}</s> #{scope_n<s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>a</s><s class='entity name function ruby'>me.g</s></s><s class='punctuation section function ruby'>s</s><s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>u</s>b<s class='punctuation definition string end ruby'>(</s></s><s class='punctuation separator object ruby'>'</s><s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>.</s>'<s class='punctuation definition string end ruby'>,</s></s><s class='punctuation section function ruby'>'</s><s class='punctuation section embedded ruby'> </s></s>')<s class='source ruby embedded source'><s class='punctuation section embedded ruby'>}'</s>&gt;<s class='punctuation section embedded ruby'>#</s></s>{line}&<s class='punctuation definition string end ruby'>l</s></s>t;/span&gt;"
</span><span class='l l-14 source ruby'>    <s class='keyword control ruby'>end</s>
</span><span class='l l-15 source ruby'>    puts <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>text</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>join</s></s><s class='punctuation section function ruby'>(</s><s class='string quoted double ruby'><s class='punctuation definition string begin ruby'>"</s><s class='punctuation definition string end ruby'>"</s></s><s class='punctuation section function ruby'>)</s>
</span><span class='l l-16 source ruby'>  <s class='keyword control ruby'>end</s>
</span><span class='l l-17 source ruby'>
</span><span class='l l-18 source ruby'><s class='comment line number-sign ruby'>  <s class='punctuation definition comment ruby'>#</s> called before processing a line
</s></span><span class='l l-19 source ruby'>  <s class='meta function method with-arguments ruby'><s class='keyword control def ruby'>def</s> <s class='entity name function ruby'>new_line</s><s class='punctuation definition parameters ruby'>(</s><s class='variable parameter function ruby'>line_content</s><s class='punctuation definition parameters ruby'>)</s></s>
</span><span class='l l-20 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>offset</s> <s class='keyword operator assignment ruby'>=</s> <s class='constant numeric ruby'>0</s>
</span><span class='l l-21 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>line</s> <s class='keyword operator assignment ruby'>=</s> line_content<s class='meta function-call method without-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>clone</s></s>
</span><span class='l l-22 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>text</s> <s class='keyword operator assignment augmented ruby'>&l</s>t<s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>;</s>&lt;</s> @line
</span><span class='l l-23 source ruby'>  <s class='keyword control ruby'>end</s>
</span><span class='l l-24 source ruby'>
</span><span class='l l-25 source ruby'>  <s class='meta function method with-arguments ruby'><s class='keyword control def ruby'>def</s> <s class='entity name function ruby'>open_tag</s><s class='punctuation definition parameters ruby'>(</s><s class='variable parameter function ruby'>tag_name<s class='punctuation separator object ruby'>,</s> position_in_current_line</s><s class='punctuation definition parameters ruby'>)</s></s>
</span><span class='l l-26 source ruby'>    tag <s class='keyword operator assignment ruby'>=</s> <s class='string quoted double ruby'><s class='punctuation definition string begin ruby'>"</s>&lt;s clas<s class='source ruby embedded source'><s class='punctuation section embedded ruby'>s=</s>'#{tag_n<s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>a</s><s class='entity name function ruby'>me.g</s></s><s class='punctuation section function ruby'>s</s><s class='string quoted double ruby'><s class='punctuation definition string begin ruby'>u</s>b<s class='punctuation definition string end ruby'>(</s></s><s class='punctuation separator object ruby'>"</s><s class='string quoted double ruby'><s class='punctuation definition string begin ruby'>.</s>"<s class='punctuation definition string end ruby'>,</s></s><s class='punctuation section function ruby'>"</s><s class='punctuation section embedded ruby'> </s></s>")<s class='punctuation definition string end ruby'>}</s></s>'&gt;"
</span><span class='l l-27 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>line</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>insert</s></s><s class='punctuation section function ruby'>(</s>position_in_current_line <s class='keyword operator arithmetic ruby'>+</s> <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>offset</s><s class='punctuation separator object ruby'>,</s> tag<s class='punctuation section function ruby'>)</s>
</span><span class='l l-28 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>offset</s> <s class='keyword operator assignment augmented ruby'>+=</s> tag<s class='meta function-call method without-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>size</s></s>
</span><span class='l l-29 source ruby'>  <s class='keyword control ruby'>end</s>
</span><span class='l l-30 source ruby'>
</span><span class='l l-31 source ruby'>  <s class='meta function method with-arguments ruby'><s class='keyword control def ruby'>def</s> <s class='entity name function ruby'>close_tag</s><s class='punctuation definition parameters ruby'>(</s><s class='variable parameter function ruby'>tag_name<s class='punctuation separator object ruby'>,</s> position_in_current_line</s><s class='punctuation definition parameters ruby'>)</s></s>
</span><span class='l l-32 source ruby'>    tag <s class='keyword operator assignment ruby'>=</s> <s class='string quoted double ruby'><s class='punctuation definition string begin ruby'>"</s>&lt;<s class='punctuation definition string end ruby'>/</s></s>s&gt;"
</span><span class='l l-33 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>line</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>insert</s></s><s class='punctuation section function ruby'>(</s>position_in_current_line <s class='keyword operator arithmetic ruby'>+</s> <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>offset</s><s class='punctuation separator object ruby'>,</s> tag<s class='punctuation section function ruby'>)</s>
</span><span class='l l-34 source ruby'>    <s class='variable other readwrite instance ruby'><s class='punctuation definition variable ruby'>@</s>offset</s> <s class='keyword operator assignment augmented ruby'>+=</s> tag<s class='meta function-call method without-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>size</s></s>
</span><span class='l l-35 source ruby'>  <s class='keyword control ruby'>end</s>
</span><span class='l l-36 source ruby'>
</span><span class='l l-37 source ruby'><s class='keyword control ruby'>end</s>
</span><span class='l l-38 source ruby'>
</span><span class='l l-39 source ruby'>syntax <s class='keyword operator assignment ruby'>=</s> <s class='support class ruby'>Textpow</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>syntax</s></s><s class='punctuation section function ruby'>(</s><s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>ruby<s class='punctuation definition string end ruby'>'</s></s><s class='punctuation section function ruby'>)</s> <s class='comment line number-sign ruby'><s class='punctuation definition comment ruby'>#</s> or 'source.ruby' or 'lib/textpow/syntax/source.ruby.syntax'
</s></span><span class='l l-40 source ruby'>processor <s class='keyword operator assignment ruby'>=</s> <s class='variable other constant ruby'>HTMLProcessor</s><s class='meta function-call method without-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>new</s></s>
</span><span class='l l-41 source ruby'>syntax<s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>parse</s></s><s class='punctuation section function ruby'>(</s>text<s class='punctuation separator object ruby'>,</s> processor<s class='punctuation section function ruby'>)</s>
</span><span class='l l-42 source ruby'>
</span><span class='l l-43 source ruby'><s class='meta require ruby'><s class='keyword other special-method ruby'>require</s> <s class='support class ruby'>File</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>expand_path</s></s><s class='punctuation section function ruby'>(</s><s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>../boot<s class='punctuation definition string end ruby'>'</s></s><s class='punctuation separator object ruby'>,</s> <s class='variable language ruby'>__FILE__</s><s class='punctuation section function ruby'>)</s></s>
</span><span class='l l-44 source ruby'>
</span><span class='l l-45 source ruby'><s class='meta require ruby'><s class='keyword other special-method ruby'>require</s> <s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>rails/all<s class='punctuation definition string end ruby'>'</s></s></s>
</span><span class='l l-46 source ruby'>
</span><span class='l l-47 source ruby'><s class='keyword control ruby'>if</s> <s class='keyword control pseudo-method ruby'>defined?</s><s class='punctuation section function ruby'>(</s><s class='variable other constant ruby'>Bundler</s><s class='punctuation section function ruby'>)</s>
</span><span class='l l-48 source ruby'><s class='comment line number-sign ruby'>  <s class='punctuation definition comment ruby'>#</s> If you precompile assets before deploying to production, use this line
</s></span><span class='l l-49 source ruby'>  <s class='support class ruby'>Bundler</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>require</s></s><s class='punctuation section function ruby'>(</s><s class='keyword operator arithmetic ruby'>*</s><s class='support class ruby'>Rails</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>groups</s></s><s class='punctuation section function ruby'>(</s><s class='constant other symbol ruby'><s class='punctuation definition constant ruby'>:</s>assets</s> <s class='punctuation separator key-value'>=&</s>g<s class='string quoted other literal lower ruby'><s class='punctuation definition string begin ruby'>t; </s>%w(development t<s class='punctuation definition string end ruby'>e</s></s><s class='punctuation section function ruby'>s</s><s class='punctuation section function ruby'>t</s>)))
</span><span class='l l-50 source ruby'><s class='comment line number-sign ruby'>  <s class='punctuation definition comment ruby'>#</s> If you want your assets lazily compiled in production, use this line
</s></span><span class='l l-51 source ruby'><s class='comment line number-sign ruby'>  <s class='punctuation definition comment ruby'>#</s> Bundler.require(:default, :assets, Rails.env)
</s></span><span class='l l-52 source ruby'><s class='keyword control ruby'>end</s>
</span><span class='l l-53 source ruby'>
</span><span class='l l-54 source ruby'><s class='meta require ruby'><s class='keyword other special-method ruby'>require</s> <s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>rubygems<s class='punctuation definition string end ruby'>'</s></s></s>
</span><span class='l l-55 source ruby'>
</span><span class='l l-56 source ruby'><s class='comment line number-sign ruby'><s class='punctuation definition comment ruby'>#</s> Set up gems listed in the Gemfile.
</s></span><span class='l l-57 source ruby'><s class='meta environment-variable ruby'><s class='variable other constant ruby'>ENV</s>[<s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>BUNDLE_GEMFILE<s class='punctuation definition string end ruby'>'</s></s>]</s> <s class='keyword operator assignment augmented ruby'>||=</s> <s class='support class ruby'>File</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>expand_path</s></s><s class='punctuation section function ruby'>(</s><s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>../../Gemfile<s class='punctuation definition string end ruby'>'</s></s><s class='punctuation separator object ruby'>,</s> <s class='variable language ruby'>__FILE__</s><s class='punctuation section function ruby'>)</s>
</span><span class='l l-58 source ruby'>
</span><span class='l l-59 source ruby'><s class='meta require ruby'><s class='keyword other special-method ruby'>require</s> <s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>bundler/setup<s class='punctuation definition string end ruby'>'</s></s> <s class='keyword control ruby'>if</s> <s class='support class ruby'>File</s><s class='meta function-call method with-arguments ruby'><s class='punctuation separator method ruby'>.</s><s class='entity name function ruby'>exists?</s></s><s class='punctuation section function ruby'>(</s><s class='meta environment-variable ruby'><s class='variable other constant ruby'>ENV</s>[<s class='string quoted single ruby'><s class='punctuation definition string begin ruby'>'</s>BUNDLE_GEMFILE<s class='punctuation definition string end ruby'>'</s></s>]</s><s class='punctuation section function ruby'>)</s></s>
</span><span class='l l-60 source ruby'>
</span><span class='l l-61 source ruby'>
</span><span class='l l-62 source ruby'>
</span><span class='l l-63 source ruby'>
</span><span class='l l-64 source ruby'>
</span><span class='l l-65 source ruby'>
</span><span class='l l-66 source ruby'>
</span><span class='l l-67 source ruby'>
</span><span class='l l-68 source ruby'>
</span><span class='l l-69 source ruby'>
</span>
